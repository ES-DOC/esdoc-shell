# Set home path
export ESDOC_HOME="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Update prommpt.
export PS1="$"

# Set repo path.
export ESDOC_CMIP6=$ESDOC_HOME/repos/esdoc-docs/cmip6

# Activate sub-shells.
if [ -d "$ESDOC_HOME/repos/esdoc-api" ]; then
	source $ESDOC_HOME/repos/esdoc-api/sh/activate
fi
if [ -d "$ESDOC_HOME/repos/esdoc-archive" ]; then
	source $ESDOC_HOME/repos/esdoc-archive/sh/activate
fi
if [ -d "$ESDOC_HOME/repos/esdoc-py-client" ]; then
	source $ESDOC_HOME/repos/esdoc-py-client/sh/activate
fi
if [ -d "$ESDOC_HOME/repos/esdoc-cdf2cim" ]; then
	source $ESDOC_HOME/repos/esdoc-cdf2cim/sh/activate
fi
if [ -d "$ESDOC_HOME/repos/esdoc-cdf2cim-ws" ]; then
	source $ESDOC_HOME/repos/esdoc-cdf2cim-ws/sh/activate
fi
if [ -d "$ESDOC_HOME/repos/esdoc-errata-ws" ]; then
	source $ESDOC_HOME/repos/esdoc-errata-ws/sh/activate
fi
if [ -d "$ESDOC_HOME/repos/esdoc-web-plugin" ]; then
	source $ESDOC_HOME/repos/esdoc-web-plugin/sh/activate
fi

# pyesdoc meta-programming commands.
alias esdoc-mp=$ESDOC_HOME/bash/pyesdoc/mp_generate.sh
alias esdoc-mp-cim-v1-sync=$ESDOC_HOME/bash/pyesdoc/mp_sync_cim_v1.sh
alias esdoc-mp-cim-v2-sync=$ESDOC_HOME/bash/pyesdoc/mp_sync_cim_v2.sh
alias esdoc-mp-cim-v1-generate='esdoc-mp-cim-v1-sync && $ESDOC_HOME/bash/pyesdoc/mp_generate_cim_1.sh'
alias esdoc-mp-cim-v2-generate='esdoc-mp-cim-v2-sync && $ESDOC_HOME/bash/pyesdoc/mp_generate_cim_2.sh'
alias esdoc-mp-cim-v1-validate='esdoc-mp-cim-v1-sync && $ESDOC_HOME/bash/pyesdoc/mp_validate_cim_1.sh'
alias esdoc-mp-cim-v2-validate='esdoc-mp-cim-v2-sync && $ESDOC_HOME/bash/pyesdoc/mp_validate_cim_2.sh'

# Security commands.
alias esdoc-gh-clone-repos=$ESDOC_HOME/bash/gh/clone_repos.sh
alias esdoc-gh-delete-teams=$ESDOC_HOME/bash/gh/delete_teams.sh
alias esdoc-gh-init-teams=$ESDOC_HOME/bash/gh/init_teams.sh
alias esdoc-gh-init-repos=$ESDOC_HOME/bash/gh/init_repos.sh
alias esdoc-gh-list-teams=$ESDOC_HOME/bash/gh/list_teams.sh
alias esdoc-gh-pull-changes=$ESDOC_HOME/bash/gh/pull_changes.sh
alias esdoc-gh-push-changes=$ESDOC_HOME/bash/gh/push_changes.sh
alias esdoc-gh-test-team-membership=$ESDOC_HOME/bash/gh/test_team_membership.sh

# Stack commands.
alias esdoc-stack-install=$ESDOC_HOME/bash/stack/install.sh
alias esdoc-stack-uninstall=$ESDOC_HOME/bash/stack/uninstall.sh
alias esdoc-stack-update=$ESDOC_HOME/bash/stack/update.sh

# Deployment commands.
alias esdoc-deployment-sync-static-assets=$ESDOC_HOME/bash/deployment/sync_static_assets.sh

# CMIP5 commands.
# alias esdoc-cmip5-archive-cim-documents=$ESDOC_HOME/bash/cmip5/archive_cim_documents.sh

# CMIP6 commands.
alias esdoc-cmip6-write-bash-vars=$ESDOC_HOME/bash/cmip6/other/write_bash_vars.sh

# ... cmip6 conformances
alias esdoc-cmip6-conformances-write-config=$ESDOC_HOME/bash/cmip6/conformances/write_config.sh
alias esdoc-cmip6-conformances-write-spreadsheets=$ESDOC_HOME/bash/cmip6/conformances/write_spreadsheets.sh

# ... cmip6 specializations
alias esdoc-cmip6-specializations-clone=$ESDOC_HOME/bash/cmip6/specializations/clone.sh
alias esdoc-cmip6-specializations-pull=$ESDOC_HOME/bash/cmip6/specializations/pull.sh
alias esdoc-cmip6-specializations-push=$ESDOC_HOME/bash/cmip6/specializations/push.sh
alias esdoc-cmip6-specializations-generate=$ESDOC_HOME/bash/cmip6/specializations/generate.sh
alias esdoc-cmip6-specializations-sync-cim-profile=$ESDOC_HOME/bash/cmip6/specializations/sync_cim_profile.sh
alias esdoc-cmip6-specializations-sync-definitions=$ESDOC_HOME/bash/cmip6/specializations/sync_definitions.sh
alias esdoc-cmip6-specializations-sync-mappings=$ESDOC_HOME/bash/cmip6/specializations/sync_mappings.sh
alias esdoc-cmip6-specializations-sync-templates=$ESDOC_HOME/bash/cmip6/specializations/sync_templates.sh
alias esdoc-cmip6-specializations-sync-tooling=$ESDOC_HOME/bash/cmip6/specializations/sync_tooling.sh
alias esdoc-cmip6-specializations-sync-viewer=$ESDOC_HOME/bash/cmip6/specializations/sync_viewer.sh
alias esdoc-cmip6-specializations-validate=$ESDOC_HOME/bash/cmip6/specializations/validate.sh

# ... cmip6 experiments
alias esdoc-cmip6-experiments-archive-cim-documents=$ESDOC_HOME/bash/cmip6/experiments/archive_cim_documents.sh
alias esdoc-cmip6-experiments-write-cim-documents=$ESDOC_HOME/bash/cmip6/experiments/write_cim_documents.sh
alias esdoc-cmip6-experiments-write-config=$ESDOC_HOME/bash/cmip6/experiments/write_config.sh
alias esdoc-cmip6-experiments-write-d3=$ESDOC_HOME/bash/cmip6/experiments/write_d3.sh

# ... cmip6 models
alias esdoc-cmip6-models-init-defaults=$ESDOC_HOME/bash/cmip6/models/init_defaults.sh
alias esdoc-cmip6-models-init-output=$ESDOC_HOME/bash/cmip6/models/init_output.sh
alias esdoc-cmip6-models-generate-pdf=$ESDOC_HOME/bash/cmip6/models/generate_pdf.sh
alias esdoc-cmip6-models-generate-xls=$ESDOC_HOME/bash/cmip6/models/generate_xls.sh

_reset_cmip6()
{
	esdoc-archive-delete-documents cmip6
	esdoc-ws-db-flush cmip6
	esdoc-cmip6-experiments-write-cim-documents
	esdoc-cmip6-experiments-write-config
	esdoc-cmip6-experiments-write-d3
	esdoc-cmip6-experiments-archive-cim-documents
	esdoc-ws-db-ingest
}
alias esdoc-cmip6-reset=_reset_cmip6

# Ensure target scripts are executable.
chmod a+x $ESDOC_HOME/bash/*.sh
chmod a+x $ESDOC_HOME/bash/*/*.sh
chmod a+x $ESDOC_HOME/bash/*/*/*.sh
