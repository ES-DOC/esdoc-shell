# Set home path
export ESDOC_HOME="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Update prommpt.
PS1="(`basename \"$ESDOC_HOME\"`)$PS1"
export PS1

# Set repo path.
export ESDOC_CMIP6=$ESDOC_HOME/repos/esdoc-docs/cmip6

# Activate sub-shells.
source $ESDOC_HOME/repos/esdoc-api/sh/activate
source $ESDOC_HOME/repos/esdoc-archive/sh/activate
source $ESDOC_HOME/repos/esdoc-py-client/sh/activate
source $ESDOC_HOME/repos/esdoc-cdf2cim/sh/activate
source $ESDOC_HOME/repos/esdoc-cdf2cim-ws/sh/activate
source $ESDOC_HOME/repos/esdoc-errata-ws/sh/activate
source $ESDOC_HOME/repos/esdoc-web-plugin/sh/activate
source $ESDOC_HOME/repos/esdoc-ws-url-rewriter/sh/activate

# pyesdoc meta-programming commands.
alias esdoc-mp=$ESDOC_HOME/bash/pyesdoc/mp_generate.sh
alias esdoc-mp-cim-v1-sync=$ESDOC_HOME/bash/pyesdoc/mp_sync_cim_v1.sh
alias esdoc-mp-cim-v2-sync=$ESDOC_HOME/bash/pyesdoc/mp_sync_cim_v2.sh
alias esdoc-mp-cim-v1-generate='esdoc-mp-cim-v1-sync && $ESDOC_HOME/bash/pyesdoc/mp_generate_cim_1.sh'
alias esdoc-mp-cim-v2-generate='esdoc-mp-cim-v2-sync && $ESDOC_HOME/bash/pyesdoc/mp_generate_cim_2.sh'
alias esdoc-mp-cim-v1-validate='esdoc-mp-cim-v1-sync && $ESDOC_HOME/bash/pyesdoc/mp_validate_cim_1.sh'
alias esdoc-mp-cim-v2-validate='esdoc-mp-cim-v2-sync && $ESDOC_HOME/bash/pyesdoc/mp_validate_cim_2.sh'

# Security commands.
alias esdoc-security-init-gh-team=$ESDOC_HOME/bash/security/init_gh_team.sh

# Stack commands.
alias esdoc-stack-install=$ESDOC_HOME/bash/stack/install.sh
alias esdoc-stack-uninstall=$ESDOC_HOME/bash/stack/uninstall.sh
alias esdoc-stack-update=$ESDOC_HOME/bash/stack/update.sh
alias esdoc-stack-update-lite=$ESDOC_HOME/bash/stack/update_lite.sh

# Deployment commands.
alias esdoc-deployment-sync-static-assets=$ESDOC_HOME/bash/deployment/sync_static_assets.sh

# CMIP6 commands.
alias esdoc-cmip6-archive-experiment-cim-documents=$ESDOC_HOME/bash/cmip6/experiments/archive_cim_documents.sh
alias esdoc-cmip6-cv-init=$ESDOC_HOME/bash/cmip6/cv/init.sh
alias esdoc-cmip6-specializations-generate=$ESDOC_HOME/bash/cmip6/specializations/generate.sh
alias esdoc-cmip6-specializations-sync=$ESDOC_HOME/bash/cmip6/specializations/sync.sh
alias esdoc-cmip6-specializations-sync-tooling=$ESDOC_HOME/bash/cmip6/specializations/sync_tooling.sh
alias esdoc-cmip6-specializations-validate=$ESDOC_HOME/bash/cmip6/specializations/validate.sh
alias esdoc-cmip6-write-experiment-cim-documents=$ESDOC_HOME/bash/cmip6/experiments/write_cim_documents.sh
alias esdoc-cmip6-write-experiment-config=$ESDOC_HOME/bash/cmip6/experiments/write_config.sh
alias esdoc-cmip6-write-experiment-d3=$ESDOC_HOME/bash/cmip6/experiments/write_d3.sh
alias esdoc-cmip6-write-model-notebooks=$ESDOC_HOME/bash/cmip6/models/write_notebooks.sh
alias esdoc-cmip6-write-model-cim-documents-from-cmip5=$ESDOC_HOME/bash/cmip6/models/write_cim_documents_from_cmip5.sh

_reset_cmip6()
{
	esdoc-archive-delete-documents cmip6-draft
	esdoc-ws-db-flush cmip6-draft
	esdoc-cmip6-write-experiment-cim-documents
	esdoc-cmip6-archive-experiment-cim-documents
	esdoc-ws-db-ingest
}
alias esdoc-cmip6-reset=_reset_cmip6

# Ensure target scripts are executable.
chmod a+x $ESDOC_HOME/bash/cmip6/cv/*.sh
chmod a+x $ESDOC_HOME/bash/cmip6/experiments/*.sh
chmod a+x $ESDOC_HOME/bash/cmip6/models/*.sh
chmod a+x $ESDOC_HOME/bash/cmip6/simulations/*.sh
chmod a+x $ESDOC_HOME/bash/cmip6/specializations/*.sh
chmod a+x $ESDOC_HOME/bash/deployment/*.sh
chmod a+x $ESDOC_HOME/bash/pyesdoc/*.sh
chmod a+x $ESDOC_HOME/bash/security/*.sh
chmod a+x $ESDOC_HOME/bash/stack/*.sh
